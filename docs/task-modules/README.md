# 任务模块化索引

> **说明**：本目录用于存放按功能域拆分的任务计划文档。当主任务文档 `/docs/TASK.md` 过于庞大时，TASK 专家会将其拆分为主从结构，此文件作为模块索引与命名规范指引。

**维护者**：TASK 专家
**创建日期**：2025-11-05
**模板版本**：v1.8

---

## 何时需要拆分任务文档？

当项目满足以下**任一条件**时，建议采用模块化任务文档：

1. **主任务文档超过 1000 行**
2. **工作包（WBS）数量超过 50 个**
3. **存在 3+ 个并行开发流（多团队/多模块）**
4. **项目周期超过 6 个月**，需要分阶段规划
5. **跨模块依赖复杂**（10+ 个依赖关系）

对于小型项目（< 20 个任务，单一团队），维护单一 `/docs/TASK.md` 即可。

---

## 命名规范

### 模块文件命名
- **格式**：`{domain}.md`（使用 kebab-case）
- **示例**：
  - `user-management.md` — 用户管理功能任务计划
  - `payment-system.md` — 支付系统任务计划
  - `notification-service.md` — 通知服务任务计划
  - `infrastructure.md` — 基础设施任务计划

### 任务 ID 规范
- **格式**：`TASK-{MODULE}-{序号}`
- **示例**：
  - `TASK-USER-001` — 用户注册功能开发
  - `TASK-PAY-005` — 支付网关集成
  - `TASK-NOTIF-012` — 邮件通知模板开发
  - `TASK-INFRA-003` — CI/CD 流水线搭建

### 里程碑 ID 规范
- **格式**：`M{序号}-{简短描述}`
- **示例**：
  - `M1-MVP` — MVP 版本发布
  - `M2-Beta` — Beta 测试版本
  - `M3-GA` — 正式版发布

---

## 模块清单

> **维护规则**：TASK 专家在创建/更新模块时，必须同步更新此表格。

| 模块名称 | 文件路径 | 负责团队 | 对应 PRD 模块 | 对应 ARCH 模块 | 状态 | 最后更新 |
|---------|---------|---------|--------------|---------------|------|---------|
| （示例）用户管理 | [user-management.md](user-management.md) | @team-backend | [prd-modules/user-management.md](../prd-modules/user-management.md) | [architecture-modules/user-management.md](../architecture-modules/user-management.md) | ✅ 已确认 | 2025-11-05 |
| （示例）支付系统 | [payment-system.md](payment-system.md) | @team-payment | [prd-modules/payment-system.md](../prd-modules/payment-system.md) | [architecture-modules/payment-system.md](../architecture-modules/payment-system.md) | 🔄 进行中 | 2025-11-05 |
| （待补充） | - | - | - | - | - | - |

**状态标识说明**：
- ✅ **已确认**：任务拆解已完成并通过评审
- 🔄 **进行中**：正在拆解或调整中
- 📝 **待启动**：计划中但尚未开始
- 🚀 **执行中**：任务已进入开发阶段
- ✔️ **已完成**：所有任务已完成

---

## 标准模块任务文档结构

每个模块任务文档应包含以下章节：

```markdown
# {模块名称}任务计划

> **所属功能域**：[链接到对应 PRD 模块] | [链接到对应 ARCH 模块]
> **负责团队**：@team-xxx
> **状态**：📝 待启动 / 🚀 执行中 / ✔️ 已完成
> **最后更新**：YYYY-MM-DD

---

## 1. 模块概述
- **业务目标**：本模块要实现的核心业务价值
- **技术范围**：涉及的技术栈与组件
- **交付物**：预期产出物（代码、文档、部署配置等）

## 2. WBS（工作分解结构）

### 2.1 任务列表
| 任务 ID | 任务名称 | 负责人 | 预估工时 | 优先级 | 前置任务 | 状态 | 完成日期 |
|---------|---------|--------|---------|--------|---------|------|---------|
| TASK-{MODULE}-001 | {任务名称} | @developer | 8h | P0 | - | 📝 待开始 | - |
| TASK-{MODULE}-002 | {任务名称} | @developer | 16h | P1 | TASK-{MODULE}-001 | 📝 待开始 | - |

**状态标识**：
- 📝 **待开始**：已规划但未开始
- 🚀 **进行中**：正在开发
- 🔄 **已提交**：已提交 PR/MR
- ✅ **已完成**：已合并并通过 QA
- ⏸️ **暂停**：因依赖或资源问题暂停
- ❌ **已取消**：需求变更取消

**优先级标识**：
- **P0**：核心功能，必须完成（阻塞发布）
- **P1**：重要功能，优先完成
- **P2**：增值功能，资源允许时完成
- **P3**：可选功能，可延后到下版本

### 2.2 任务详细说明

#### TASK-{MODULE}-001: {任务名称}
**描述**：详细描述任务内容与验收标准

**输入**：
- PRD 需求：US-{MODULE}-{序号}（链接到 PRD）
- 设计文档：ARCH-{MODULE}（链接到架构文档）

**输出**：
- 代码：`/path/to/code`
- 测试：单元测试覆盖率 > 80%
- 文档：API 文档 / 代码注释

**验收标准**：
- [ ] 功能实现符合 PRD 验收条件
- [ ] 测试覆盖率达标（单元测试 > 80%，集成测试关键路径）
- [ ] 代码评审通过
- [ ] 文档同步更新（API 文档、CHANGELOG）

**风险**：
- 潜在风险1：{描述} — 缓解措施：{方案}

## 3. 依赖关系矩阵

### 3.1 内部依赖（本模块内）
| 任务 | 依赖任务 | 依赖类型 | 说明 |
|------|---------|---------|------|
| TASK-{MODULE}-002 | TASK-{MODULE}-001 | FS（Finish-to-Start） | 需先完成数据模型设计 |

**依赖类型说明**：
- **FS（Finish-to-Start）**：前置任务完成后才能开始
- **SS（Start-to-Start）**：前置任务开始后才能开始
- **FF（Finish-to-Finish）**：前置任务完成后才能完成
- **SF（Start-to-Finish）**：前置任务开始后才能完成（罕见）

### 3.2 外部依赖（跨模块）
| 本模块任务 | 依赖模块 | 依赖任务 | 阻塞影响 | 协调方式 |
|-----------|---------|---------|---------|---------|
| TASK-{MODULE}-010 | payment-system | TASK-PAY-003 | 高 | 需与 @team-payment 每周对齐接口契约 |

## 4. 资源与时间线

### 4.1 人力资源分配
| 角色 | 人员 | 分配任务 | 工时预算 | 备注 |
|------|------|---------|---------|------|
| 后端开发 | @dev-backend-1 | TASK-{MODULE}-001~005 | 80h | - |
| 前端开发 | @dev-frontend-1 | TASK-{MODULE}-006~010 | 60h | - |
| 测试工程师 | @qa-engineer-1 | 测试用例编写与执行 | 40h | 与 TDD 并行 |

### 4.2 时间线（甘特图 - 文本格式）
```
Week 1  | TASK-001 ████████
        | TASK-002        ████████
Week 2  | TASK-002        ████████
        | TASK-003               ████████
Week 3  | TASK-004                      ████████
```
*（推荐使用 Mermaid 或 PlantUML 生成可视化甘特图）*

## 5. 里程碑（模块级）
| 里程碑 ID | 里程碑名称 | 目标日期 | 交付物 | 验收标准 | 状态 |
|----------|----------|---------|--------|---------|------|
| M{X}.1 | {模块}功能完成 | YYYY-MM-DD | 所有 P0/P1 任务完成 | TDD 专家验收通过 | 📝 待完成 |
| M{X}.2 | {模块}测试通过 | YYYY-MM-DD | QA 验收报告 | 无 P0/P1 缺陷 | 📝 待完成 |

## 6. 风险登记（模块级）
| 风险 ID | 风险描述 | 概率 | 影响 | 风险等级 | 缓解措施 | 应急预案 | 负责人 |
|---------|---------|------|------|---------|---------|---------|--------|
| RISK-{MODULE}-001 | 第三方 API 不稳定 | 中 | 高 | 🔴 高 | 增加重试机制+降级方案 | 使用本地 Mock 数据 | @tech-lead |
| RISK-{MODULE}-002 | 团队成员请假 | 低 | 中 | 🟡 中 | 任务交叉培训 | 调配备用人员 | @pm |

**风险等级**：
- 🔴 **高**：概率高 & 影响高（需立即制定缓解措施）
- 🟡 **中**：概率中 & 影响中（需监控并准备预案）
- 🟢 **低**：概率低 & 影响低（仅记录，不主动干预）

## 7. 沟通与协作
- **站会频率**：每日/每周（根据团队规模）
- **同步机制**：Slack #channel / 飞书群
- **文档协作**：本文件实时更新，重大变更通知相关方
- **问题升级**：阻塞问题 24h 内上报给 @pm 或 @tech-lead

## 8. 变更记录
| 版本 | 日期 | 变更类型 | 变更描述 | 负责人 |
|------|------|---------|---------|--------|
| v0.1 | YYYY-MM-DD | 新增 | 初始版本 | @pm |

---

> **维护说明**：本文档由 TASK 专家在 Phase 3 创建并持续维护。任务状态与完成日期需实时更新，重大变更需同步通知 TDD 专家与 QA 专家。
```

---

## 跨模块协作规范

### 与 PRD 专家协作
- **输入**：读取 `/docs/prd-modules/{domain}.md` 对应的 PRD 模块
- **对齐**：确保任务拆解覆盖所有用户故事（US）
- **追溯**：任务 ID 与 Story ID 建立映射关系（在追溯矩阵中维护）

### 与 ARCHITECTURE 专家协作
- **输入**：读取 `/docs/architecture-modules/{domain}.md` 对应的架构模块
- **技术约束**：遵循架构设计的技术选型与接口契约
- **任务粒度**：根据架构分层（前端/后端/数据库）拆解任务

### 与 TDD 专家协作
- **输出**：TDD 专家按任务列表顺序实现功能
- **状态同步**：TDD 专家完成任务后，更新本文件的任务状态（🚀 → 🔄 → ✅）
- **依赖管理**：若任务被阻塞，及时通知 TASK 专家调整计划

### 与 QA 专家协作
- **测试计划**：QA 专家基于任务列表制定测试用例
- **里程碑验收**：QA 专家在模块里程碑完成后执行验收测试
- **缺陷反馈**：QA 专家发现缺陷后，TASK 专家评估影响并调整任务优先级

---

## 模块化工作流

1. **拆分评估**：TASK 专家根据拆分条件，决定是否采用模块化
2. **创建主任务文档**：在 `/docs/TASK.md` 维护总纲与模块索引（< 500 行）
3. **创建模块任务文档**：在本目录下创建 `{domain}.md` 详细计划
4. **更新模块索引**：在本文件的"模块清单"表格中注册新模块
5. **与团队对齐**：召开 Kick-off 会议，确认任务分配与时间线
6. **持续更新**：任务状态实时更新，每周回顾进度与风险

---

## 常见问题

### Q1: 如何决定任务拆分粒度？
**A**: 遵循以下原则：
- **SMART 原则**：任务具体、可衡量、可实现、相关、有时限
- **时间盒**：单个任务 < 2 天（16 工时）；超过则继续拆分
- **独立性**：任务应尽量独立，减少并行冲突
- **可测试**：任务完成后能独立验证（单元测试/集成测试）

### Q2: 如何管理跨模块依赖？
**A**:
- **显式声明**：在"外部依赖"表格中明确列出
- **接口先行**：优先定义接口契约，并行开发
- **契约测试**：通过 Mock/Stub 模拟依赖模块
- **定期对齐**：每周与依赖模块团队同步进度

### Q3: 任务延期如何处理？
**A**:
1. **及时预警**：任务预计延期 > 1 天，立即通知 @pm
2. **影响评估**：分析对下游任务与里程碑的影响
3. **调整计划**：重新排期或调整资源分配
4. **升级机制**：影响里程碑时，升级至 @tech-lead 或 @stakeholder

### Q4: 如何从单一任务文档迁移到模块化？
**A**:
1. 保持主 `/docs/TASK.md` 作为总纲
2. 按功能域逐步拆分，每个模块对应一个新文件
3. 在主文档中保留模块索引与全局依赖关系
4. 历史任务保留在主文档，新任务写入模块文档

---

## 相关文档

- **主任务文档**：[/docs/TASK.md](../TASK.md)
- **PRD 模块索引**：[/docs/prd-modules/README.md](../prd-modules/README.md)
- **ARCH 模块索引**：[/docs/architecture-modules/README.md](../architecture-modules/README.md)
- **QA 模块索引**：[/docs/qa-modules/README.md](../qa-modules/README.md)
- **追溯矩阵**：[/docs/data/traceability-matrix.md](../data/traceability-matrix.md)
- **目录规范**：[/docs/CONVENTIONS.md](../CONVENTIONS.md)

---

> **注意**：本索引文件必须与 `/docs/TASK.md` 中的"模块任务索引"章节保持同步。任何模块的新增、修改、完成都必须同时更新两处。
