# DEPLOY-{YYYYMMDD}-{SEQ}-{env}

> **用途**：由 DevOps 专家在每次 staging/production 部署时创建，存放于 `/docs/data/deployments/`。

## 基本信息

| 项目 | 内容 |
| ---- | ---- |
| **环境** | staging / production |
| **版本/标签** | vX.Y.Z |
| **Commit** | abc1234 |
| **部署时间** | YYYY-MM-DD HH:MM |
| **部署方式** | `/ship prod` / `/cd prod` |
| **执行人** | @devops |
| **触发来源** | QA 发布建议 Go / Hotfix / 定期发布 |

## 部署前检查清单

- [ ] QA 发布建议为 Go 或 Conditional
- [ ] CI 全绿
- [ ] CHANGELOG.md 与交付内容一致
- [ ] DB 迁移已验证（如适用）
- [ ] 回滚方案已准备
- [ ] 必要审批已完成（production）

## 冒烟测试结果

| 检查项 | 状态 | 备注 |
| ------ | ---- | ---- |
| 健康端点 200 | Pass / Fail | |
| 核心用户流程 | Pass / Fail | |
| 外部服务连通性 | Pass / Fail | |

## 关键指标监控（15 分钟）

| 指标 | 基线值 | 部署后值 | 状态 |
| ---- | ------ | -------- | ---- |
| 错误率（Error Rate） | X% | X% | 正常 / 异常 |
| 延迟 P95 | Xms | Xms | 正常 / 异常 |
| 吞吐量（RPS） | X | X | 正常 / 异常 |
| CPU 占用 | X% | X% | 正常 / 异常 |
| 内存占用 | X% | X% | 正常 / 异常 |

## 结果

- **部署状态**：成功 / 失败 / 已回滚
- **Git Tag**：vX.Y.Z（已推送 / 未创建）
- **通知状态**：已通知 QA Lead、Tech Lead
- **监控链接**：（仪表盘 URL）

## 回滚记录

> 仅在发生回滚时填写本段，无回滚时删除或标注"无"。

| 项目 | 内容 |
| ---- | ---- |
| **回滚时间** | YYYY-MM-DD HH:MM |
| **回滚级别** | L1 应用层 / L2 数据库 / L3 全量 |
| **回滚方式** | `deploy.sh --rollback` / `git revert` |
| **回滚原因** | 简述触发回滚的问题 |
| **影响范围** | 受影响的用户/功能 |
| **恢复确认** | 冒烟通过时间 |
| **后续处理** | 退回 TDD / QA 阶段，QA 缺陷 ID |

### 事后回顾（Production 回滚必填，24h 内完成）

- **时间线**：部署 → 发现问题 → 决策回滚 → 执行回滚 → 恢复确认
- **根因分析**：
- **影响评估**：
- **改进措施**：
- **关联 ADR**：ADR-XXX（如有）
